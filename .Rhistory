Min_Pre = importRatings$dis_csminus_2,
Min_Mid = importRatings$dis_csminus_3,
Min_Post = importRatings$dis_csminus_4
)
dataDisgustLong <- gather(data = dataDisgust, key = "cond", value = "disgust",
Av_Pre:Min_Post)
dataDisgustLong <- separate(data = dataDisgustLong, col = cond, into = c("CS","time"),
sep = "_")
dataDisgustLong$CS <- factor(dataDisgustLong$CS, levels = c("Av", "Neu", "Min"))
dataDisgustLong$time <- factor(dataDisgustLong$time, levels = c("Pre", "Mid", "Post"))
#############################
### Plots for all ratings ###
#############################
# remove between-subject variance for plotting standard errors based on
# within-subject variance
dataUnpleasLongPost <- dataUnpleas[,c("partInd","usGroup","Av_Post","Neu_Post","Min_Post")]
dataArousalLongPost <- dataArousal[,c("partInd","usGroup","Av_Post","Neu_Post","Min_Post")]
dataAngerLongPost <- dataAnger[,c("partInd","usGroup","Av_Post","Neu_Post","Min_Post")]
dataDisgustLongPost <- dataDisgust[,c("partInd","usGroup","Av_Post","Neu_Post","Min_Post")]
# remove each participant's average from each single value
dataUnpleasLongPost[dataUnpleasLongPost$usGroup == "ima",6:8] <- as.matrix(dataUnpleasLongPost[dataUnpleasLongPost$usGroup == "ima",3:5]) -
rowMeans(as.matrix(dataUnpleasLongPost[dataUnpleasLongPost$usGroup == "ima",3:5])) + mean(as.matrix(dataUnpleasLongPost[dataUnpleasLongPost$usGroup == "ima",3:5]))
dataUnpleasLongPost[dataUnpleasLongPost$usGroup == "real",6:8] <- as.matrix(dataUnpleasLongPost[dataUnpleasLongPost$usGroup == "real",3:5]) -
rowMeans(as.matrix(dataUnpleasLongPost[dataUnpleasLongPost$usGroup == "real",3:5])) + mean(as.matrix(dataUnpleasLongPost[dataUnpleasLongPost$usGroup == "real",3:5]))
names(dataUnpleasLongPost) <- c("partInd","usGroup","Av_btw","Neu_btw","Min_btw","Av_wth","Neu_wth","Min_wth")
dataArousalLongPost[dataArousalLongPost$usGroup == "ima",6:8] <- as.matrix(dataArousalLongPost[dataArousalLongPost$usGroup == "ima",3:5]) -
rowMeans(as.matrix(dataArousalLongPost[dataArousalLongPost$usGroup == "ima",3:5])) + mean(as.matrix(dataArousalLongPost[dataArousalLongPost$usGroup == "ima",3:5]))
dataArousalLongPost[dataArousalLongPost$usGroup == "real",6:8] <- as.matrix(dataArousalLongPost[dataArousalLongPost$usGroup == "real",3:5]) -
rowMeans(as.matrix(dataArousalLongPost[dataArousalLongPost$usGroup == "real",3:5])) + mean(as.matrix(dataArousalLongPost[dataArousalLongPost$usGroup == "real",3:5]))
names(dataArousalLongPost) <- c("partInd","usGroup","Av_btw","Neu_btw","Min_btw","Av_wth","Neu_wth","Min_wth")
dataAngerLongPost[dataAngerLongPost$usGroup == "ima",6:8] <- as.matrix(dataAngerLongPost[dataAngerLongPost$usGroup == "ima",3:5]) -
rowMeans(as.matrix(dataAngerLongPost[dataAngerLongPost$usGroup == "ima",3:5])) + mean(as.matrix(dataAngerLongPost[dataAngerLongPost$usGroup == "ima",3:5]))
dataAngerLongPost[dataAngerLongPost$usGroup == "real",6:8] <- as.matrix(dataAngerLongPost[dataAngerLongPost$usGroup == "real",3:5]) -
rowMeans(as.matrix(dataAngerLongPost[dataAngerLongPost$usGroup == "real",3:5])) + mean(as.matrix(dataAngerLongPost[dataAngerLongPost$usGroup == "real",3:5]))
names(dataAngerLongPost) <- c("partInd","usGroup","Av_btw","Neu_btw","Min_btw","Av_wth","Neu_wth","Min_wth")
dataDisgustLongPost[dataDisgustLongPost$usGroup == "ima",6:8] <- as.matrix(dataDisgustLongPost[dataDisgustLongPost$usGroup == "ima",3:5]) -
rowMeans(as.matrix(dataDisgustLongPost[dataDisgustLongPost$usGroup == "ima",3:5])) + mean(as.matrix(dataDisgustLongPost[dataDisgustLongPost$usGroup == "ima",3:5]))
dataDisgustLongPost[dataDisgustLongPost$usGroup == "real",6:8] <- as.matrix(dataDisgustLongPost[dataDisgustLongPost$usGroup == "real",3:5]) -
rowMeans(as.matrix(dataDisgustLongPost[dataDisgustLongPost$usGroup == "real",3:5])) + mean(as.matrix(dataDisgustLongPost[dataDisgustLongPost$usGroup == "real",3:5]))
names(dataDisgustLongPost) <- c("partInd","usGroup","Av_btw","Neu_btw","Min_btw","Av_wth","Neu_wth","Min_wth")
# into long format
dataUnpleasLongPost <- pivot_longer(data = dataUnpleasLongPost, cols = Av_btw:Min_wth,
names_to = c("CS","variance"), names_sep = "_", values_to = "fear")
dataUnpleasLongPost <- pivot_wider(data = dataUnpleasLongPost, names_from = "variance", values_from = "fear")
dataUnpleasLongPost$CS <- factor(dataUnpleasLongPost$CS, levels = c("Av","Neu","Min"))
levels(dataUnpleasLongPost$usGroup) <- c("Imagery-based","Classical")
dataArousalLongPost <- pivot_longer(data = dataArousalLongPost, cols = Av_btw:Min_wth,
names_to = c("CS","variance"), names_sep = "_", values_to = "fear")
dataArousalLongPost <- pivot_wider(data = dataArousalLongPost, names_from = "variance", values_from = "fear")
dataArousalLongPost$CS <- factor(dataArousalLongPost$CS, levels = c("Av","Neu","Min"))
levels(dataArousalLongPost$usGroup) <- c("Imagery-based","Classical")
dataAngerLongPost <- pivot_longer(data = dataAngerLongPost, cols = Av_btw:Min_wth,
names_to = c("CS","variance"), names_sep = "_", values_to = "fear")
dataAngerLongPost <- pivot_wider(data = dataAngerLongPost, names_from = "variance", values_from = "fear")
dataAngerLongPost$CS <- factor(dataAngerLongPost$CS, levels = c("Av","Neu","Min"))
levels(dataAngerLongPost$usGroup) <- c("Imagery-based","Classical")
dataDisgustLongPost <- pivot_longer(data = dataDisgustLongPost, cols = Av_btw:Min_wth,
names_to = c("CS","variance"), names_sep = "_", values_to = "fear")
dataDisgustLongPost <- pivot_wider(data = dataDisgustLongPost, names_from = "variance", values_from = "fear")
dataDisgustLongPost$CS <- factor(dataDisgustLongPost$CS, levels = c("Av","Neu","Min"))
levels(dataDisgustLongPost$usGroup) <- c("Imagery-based","Classical")
# some general settings
plotFS <- 8
showSig <- TRUE
csLabels = c(expression(paste("CS+"[av])), expression(paste("CS+"[neu])), "CS-")
# graphs of group x CS effects on unpleasantness ratings
graphUnpleas <- ggplot(data = dataUnpleasLongPost, aes(x = usGroup, y = btw, fill = CS, color = CS)) +
theme_classic() +
stat_summary(aes(y = wth), fun.data = mean_se, geom = "errorbar", position=position_dodge(0.8), width = 0.1, linewidth = 0.2) +
stat_summary(fun = mean, geom = "crossbar", position = position_dodge(0.8), width = 0.25, linewidth = 0.2) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_color_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_y_continuous(name = "Unpleasantness rating (1-5)", limits = c(0.4,6), breaks = 1:5, oob = rescale_none, expand = c(0,0)) +
geom_vline(xintercept = 0.41) +
geom_rect(xmin = 0.4, xmax = 2.6, ymin = 0.35, ymax = 0.8, fill = "white", color = "white") +
geom_hline(yintercept = 0.8) +
geom_beeswarm(aes(color = CS), dodge.width = 0.8, cex = 0.6, size = .1, color = "gray70") +
geom_violin(alpha = .2, color = NA, bw = .5, position = position_dodge(0.8), width = 0.75) +
geom_text(x = 0.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(aes(label = usGroup, y = 5.9), colour = "black", size = (plotFS-2)/.pt, fontface = "bold") +
theme(legend.position = "none",
plot.title = element_text(size = plotFS, color = "black", face = "bold", hjust = .5),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.y  = element_blank(),
axis.title.y = element_text(margin = margin(r = 5), size = plotFS),
axis.text.y = element_text(margin = margin(r = 5), size = plotFS, color = "black"),
axis.ticks.y = element_line(colour = "black"))
library(ggbeeswarm)
# graphs of group x CS effects on unpleasantness ratings
graphUnpleas <- ggplot(data = dataUnpleasLongPost, aes(x = usGroup, y = btw, fill = CS, color = CS)) +
theme_classic() +
stat_summary(aes(y = wth), fun.data = mean_se, geom = "errorbar", position=position_dodge(0.8), width = 0.1, linewidth = 0.2) +
stat_summary(fun = mean, geom = "crossbar", position = position_dodge(0.8), width = 0.25, linewidth = 0.2) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_color_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_y_continuous(name = "Unpleasantness rating (1-5)", limits = c(0.4,6), breaks = 1:5, oob = rescale_none, expand = c(0,0)) +
geom_vline(xintercept = 0.41) +
geom_rect(xmin = 0.4, xmax = 2.6, ymin = 0.35, ymax = 0.8, fill = "white", color = "white") +
geom_hline(yintercept = 0.8) +
geom_beeswarm(aes(color = CS), dodge.width = 0.8, cex = 0.6, size = .1, color = "gray70") +
geom_violin(alpha = .2, color = NA, bw = .5, position = position_dodge(0.8), width = 0.75) +
geom_text(x = 0.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(aes(label = usGroup, y = 5.9), colour = "black", size = (plotFS-2)/.pt, fontface = "bold") +
theme(legend.position = "none",
plot.title = element_text(size = plotFS, color = "black", face = "bold", hjust = .5),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.y  = element_blank(),
axis.title.y = element_text(margin = margin(r = 5), size = plotFS),
axis.text.y = element_text(margin = margin(r = 5), size = plotFS, color = "black"),
axis.ticks.y = element_line(colour = "black"))
if (showSig == TRUE){
graphUnpleas <- graphUnpleas +
geom_segment(aes(x = 0.74, y = 5.1, xend = 1.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 0.85, y =5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 0.74, y = 5.4, xend = 1.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.1, xend = 2.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.85, y = 5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.4, xend = 2.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 2.0, y = 5.45), size = plotFS/4, color = "gray20")
}
graphUnpleas
# graphs of group x CS effects on arousal ratings
graphArousal <- ggplot(data = dataArousalLongPost, aes(x = usGroup, y = btw, fill = CS, color = CS)) +
theme_classic() +
stat_summary(aes(y = wth), fun.data = mean_se, geom = "errorbar", position=position_dodge(0.8), width = 0.1, linewidth = 0.2) +
stat_summary(fun = mean, geom = "crossbar", position = position_dodge(0.8), width = 0.25, linewidth = 0.2) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_color_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_y_continuous(name = "Arousal rating (1-5)", limits = c(0.4,6), breaks = 1:5, oob = rescale_none, expand = c(0,0)) +
geom_vline(xintercept = 0.41) +
geom_rect(xmin = 0.4, xmax = 2.6, ymin = 0.35, ymax = 0.8, fill = "white", color = "white") +
geom_hline(yintercept = 0.8) +
geom_beeswarm(aes(color = CS), dodge.width = 0.8, cex = 0.6, size = .1, color = "gray70") +
geom_violin(alpha = .2, color = NA, bw = .5, position = position_dodge(0.8), width = 0.75) +
geom_text(x = 0.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(aes(label = usGroup, y = 5.9), colour = "black", size = (plotFS-2)/.pt, fontface = "bold") +
theme(legend.position = "none",
plot.title = element_text(size = plotFS, color = "black", face = "bold", hjust = .5),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.y  = element_blank(),
axis.title.y = element_text(margin = margin(r = 5), size = plotFS),
axis.text.y = element_text(margin = margin(r = 5), size = plotFS, color = "black"),
axis.ticks.y = element_line(colour = "black"))
if (showSig == TRUE){
graphArousal <- graphArousal +
geom_segment(aes(x = 1.0, y = 5.1, xend = 1.26, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "**", x = 0.85, y =5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 0.74, y = 5.4, xend = 1.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.1, xend = 2.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.85, y = 5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.4, xend = 2.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 2.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 2.0, y = 5.1, xend = 2.26, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "**", x = 2.0, y = 5.15), size = plotFS/4, color = "gray20")
}
graphArousal
# graphs of group x CS effects on anger ratings
graphAnger <- ggplot(data = dataAngerLongPost, aes(x = usGroup, y = btw, fill = CS, color = CS)) +
theme_classic() +
stat_summary(aes(y = wth), fun.data = mean_se, geom = "errorbar", position=position_dodge(0.8), width = 0.1, linewidth = 0.2) +
stat_summary(fun = mean, geom = "crossbar", position = position_dodge(0.8), width = 0.25, linewidth = 0.2) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_color_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_y_continuous(name = "Anger rating (1-5)", limits = c(0.4,6), breaks = 1:5, oob = rescale_none, expand = c(0,0)) +
geom_vline(xintercept = 0.41) +
geom_rect(xmin = 0.4, xmax = 2.6, ymin = 0.35, ymax = 0.8, fill = "white", color = "white") +
geom_hline(yintercept = 0.8) +
geom_beeswarm(aes(color = CS), dodge.width = 0.8, cex = 0.6, size = .1, color = "gray70") +
geom_violin(alpha = .2, color = NA, bw = .5, position = position_dodge(0.8), width = 0.75) +
geom_text(x = 0.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(aes(label = usGroup, y = 5.9), colour = "black", size = (plotFS-2)/.pt, fontface = "bold") +
theme(legend.position = "none",
plot.title = element_text(size = plotFS, color = "black", face = "bold", hjust = .5),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.y  = element_blank(),
axis.title.y = element_text(margin = margin(r = 5), size = plotFS),
axis.text.y = element_text(margin = margin(r = 5), size = plotFS, color = "black"),
axis.ticks.y = element_line(colour = "black"))
if (showSig == TRUE){
graphAnger <- graphAnger +
geom_segment(aes(x = 0.74, y = 5.1, xend = 1.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 0.85, y =5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 0.74, y = 5.4, xend = 1.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.1, xend = 2.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.85, y = 5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.4, xend = 2.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 2.0, y = 5.45), size = plotFS/4, color = "gray20")
}
graphAnger
# graphs of group x CS effects on disgust ratings
graphDisgust <- ggplot(data = dataDisgustLongPost, aes(x = usGroup, y = btw, fill = CS, color = CS)) +
theme_classic() +
stat_summary(aes(y = wth), fun.data = mean_se, geom = "errorbar", position=position_dodge(0.8), width = 0.1, linewidth = 0.2) +
stat_summary(fun = mean, geom = "crossbar", position = position_dodge(0.8), width = 0.25, linewidth = 0.2) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_color_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_y_continuous(name = "Disgust rating (1-5)", limits = c(0.4,6), breaks = 1:5, oob = rescale_none, expand = c(0,0)) +
geom_vline(xintercept = 0.41) +
geom_rect(xmin = 0.4, xmax = 2.6, ymin = 0.35, ymax = 0.8, fill = "white", color = "white") +
geom_hline(yintercept = 0.8) +
geom_beeswarm(aes(color = CS), dodge.width = 0.8, cex = 0.6, size = .1, color = "gray70") +
geom_violin(alpha = .2, color = NA, bw = .5, position = position_dodge(0.8), width = 0.75) +
geom_text(x = 0.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.7, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.3, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(aes(label = usGroup, y = 5.9), colour = "black", size = (plotFS-2)/.pt, fontface = "bold") +
theme(legend.position = "none",
plot.title = element_text(size = plotFS, color = "black", face = "bold", hjust = .5),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.y  = element_blank(),
axis.title.y = element_text(margin = margin(r = 5), size = plotFS),
axis.text.y = element_text(margin = margin(r = 5), size = plotFS, color = "black"),
axis.ticks.y = element_line(colour = "black"))
if (showSig == TRUE){
graphDisgust <- graphDisgust +
geom_segment(aes(x = 0.74, y = 5.1, xend = 1.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 0.85, y =5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 0.74, y = 5.4, xend = 1.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.1, xend = 2.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "**", x = 1.85, y = 5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.4, xend = 2.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "**", x = 2.0, y = 5.45), size = plotFS/4, color = "gray20")
}
graphDisgust
### combining graphs into one figure
# add margins to subplots
graphUnpleas <- graphUnpleas + theme(plot.margin = unit(c(5,5,5,5), "mm"))
graphArousal <- graphArousal + theme(plot.margin = unit(c(5,5,5,5), "mm"))
graphAnger <- graphAnger + theme(plot.margin = unit(c(5,5,5,5), "mm"))
graphDisgust <- graphDisgust + theme(plot.margin = unit(c(5,5,5,5), "mm"))
# make a dummy graph to extract the legend
dummyGraph <- ggplot(data = plotDataDisgust, aes(x = usGroup, y = mean, fill = CS)) +
geom_col(aes(fill = CS), position = position_dodge(width = .9)) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
theme(legend.title = element_blank())
# make a dummy graph to extract the legend
dummyGraph <- ggplot(data = dataDisgustLong, aes(x = usGroup, y = mean, fill = CS)) +
geom_col(aes(fill = CS), position = position_dodge(width = .9)) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
theme(legend.title = element_blank())
graphLegend <- get_legend(dummyGraph)
# merging the subplots
# graphRatings <- ggarrange(graphUnpleas, graphArousal, graphLegend,
#                           graphAnger, graphDisgust,
#                           labels = c("A", "B", "", "C", "D"),
#                           ncol = 3, nrow = 2,
#                           widths = c(3,3,1))
graphRatings <- ggarrange(graphUnpleas, graphArousal,
graphAnger, graphDisgust,
labels = c("A", "B", "C", "D"),
ncol = 2, nrow = 2)
graphRatings
graphRatings
# saving it
ggsave(filename = paste0(pathname, "/supplement/FigureSupp_plotOtherRatings.eps"),
plot = graphRatings,
width = 210,
height = 180,
units = "mm",
dpi = 300
)
ggsave(filename = paste0(pathname, "/supplement/FigureSupp_plotOtherRatings.pdf"),
plot = graphRatings,
device = "pdf",
width = 210,
height = 180,
units = "mm",
dpi = 300
)
# some general settings
plotFS <- 8
showSig <- TRUE
csLabels = c(expression(paste("CS+"[av])), expression(paste("CS+"[neu])), "CS-")
# graphs of group x CS effects on unpleasantness ratings
graphUnpleas <- ggplot(data = dataUnpleasLongPost, aes(x = usGroup, y = btw, fill = CS, color = CS)) +
theme_classic() +
stat_summary(aes(y = wth), fun.data = mean_se, geom = "errorbar", position=position_dodge(0.8), width = 0.1, linewidth = 0.2) +
stat_summary(fun = mean, geom = "crossbar", position = position_dodge(0.8), width = 0.25, linewidth = 0.2) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_color_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_y_continuous(name = "Unpleasantness rating (1-5)", limits = c(0.4,6), breaks = 1:5, oob = rescale_none, expand = c(0,0)) +
geom_vline(xintercept = 0.41) +
geom_rect(xmin = 0.4, xmax = 2.6, ymin = 0.35, ymax = 0.8, fill = "white", color = "white") +
geom_hline(yintercept = 0.8) +
geom_beeswarm(aes(color = CS), dodge.width = 0.8, cex = 0.6, size = .1, color = "gray70") +
geom_violin(alpha = .2, color = NA, bw = .5, position = position_dodge(0.8), width = 0.75) +
geom_text(x = 0.74, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.26, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.74, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.26, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(aes(label = usGroup, y = 5.9), colour = "black", size = (plotFS-2)/.pt, fontface = "bold") +
theme(legend.position = "none",
plot.title = element_text(size = plotFS, color = "black", face = "bold", hjust = .5),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.y  = element_blank(),
axis.title.y = element_text(margin = margin(r = 5), size = plotFS),
axis.text.y = element_text(margin = margin(r = 5), size = plotFS, color = "black"),
axis.ticks.y = element_line(colour = "black"))
if (showSig == TRUE){
graphUnpleas <- graphUnpleas +
geom_segment(aes(x = 0.74, y = 5.1, xend = 1.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 0.87, y =5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 0.74, y = 5.4, xend = 1.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.1, xend = 2.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.87, y = 5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.4, xend = 2.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 2.0, y = 5.45), size = plotFS/4, color = "gray20")
}
graphUnpleas
# graphs of group x CS effects on arousal ratings
graphArousal <- ggplot(data = dataArousalLongPost, aes(x = usGroup, y = btw, fill = CS, color = CS)) +
theme_classic() +
stat_summary(aes(y = wth), fun.data = mean_se, geom = "errorbar", position=position_dodge(0.8), width = 0.1, linewidth = 0.2) +
stat_summary(fun = mean, geom = "crossbar", position = position_dodge(0.8), width = 0.25, linewidth = 0.2) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_color_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_y_continuous(name = "Arousal rating (1-5)", limits = c(0.4,6), breaks = 1:5, oob = rescale_none, expand = c(0,0)) +
geom_vline(xintercept = 0.41) +
geom_rect(xmin = 0.4, xmax = 2.6, ymin = 0.35, ymax = 0.8, fill = "white", color = "white") +
geom_hline(yintercept = 0.8) +
geom_beeswarm(aes(color = CS), dodge.width = 0.8, cex = 0.6, size = .1, color = "gray70") +
geom_violin(alpha = .2, color = NA, bw = .5, position = position_dodge(0.8), width = 0.75) +
geom_text(x = 0.74, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.26, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.74, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.26, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(aes(label = usGroup, y = 5.9), colour = "black", size = (plotFS-2)/.pt, fontface = "bold") +
theme(legend.position = "none",
plot.title = element_text(size = plotFS, color = "black", face = "bold", hjust = .5),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.y  = element_blank(),
axis.title.y = element_text(margin = margin(r = 5), size = plotFS),
axis.text.y = element_text(margin = margin(r = 5), size = plotFS, color = "black"),
axis.ticks.y = element_line(colour = "black"))
if (showSig == TRUE){
graphArousal <- graphArousal +
geom_segment(aes(x = 1.0, y = 5.1, xend = 1.26, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "**", x = 1.13, y = 5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 0.74, y = 5.4, xend = 1.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.1, xend = 1.99, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.87, y = 5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.4, xend = 2.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 2.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 2.01, y = 5.1, xend = 2.26, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "**", x = 2.13, y = 5.15), size = plotFS/4, color = "gray20")
}
graphArousal
# graphs of group x CS effects on anger ratings
graphAnger <- ggplot(data = dataAngerLongPost, aes(x = usGroup, y = btw, fill = CS, color = CS)) +
theme_classic() +
stat_summary(aes(y = wth), fun.data = mean_se, geom = "errorbar", position=position_dodge(0.8), width = 0.1, linewidth = 0.2) +
stat_summary(fun = mean, geom = "crossbar", position = position_dodge(0.8), width = 0.25, linewidth = 0.2) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_color_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_y_continuous(name = "Anger rating (1-5)", limits = c(0.4,6), breaks = 1:5, oob = rescale_none, expand = c(0,0)) +
geom_vline(xintercept = 0.41) +
geom_rect(xmin = 0.4, xmax = 2.6, ymin = 0.35, ymax = 0.8, fill = "white", color = "white") +
geom_hline(yintercept = 0.8) +
geom_beeswarm(aes(color = CS), dodge.width = 0.8, cex = 0.6, size = .1, color = "gray70") +
geom_violin(alpha = .2, color = NA, bw = .5, position = position_dodge(0.8), width = 0.75) +
geom_text(x = 0.74, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.26, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.74, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.26, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(aes(label = usGroup, y = 5.9), colour = "black", size = (plotFS-2)/.pt, fontface = "bold") +
theme(legend.position = "none",
plot.title = element_text(size = plotFS, color = "black", face = "bold", hjust = .5),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.y  = element_blank(),
axis.title.y = element_text(margin = margin(r = 5), size = plotFS),
axis.text.y = element_text(margin = margin(r = 5), size = plotFS, color = "black"),
axis.ticks.y = element_line(colour = "black"))
if (showSig == TRUE){
graphAnger <- graphAnger +
geom_segment(aes(x = 0.74, y = 5.1, xend = 1.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 0.87, y =5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 0.74, y = 5.4, xend = 1.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.1, xend = 2.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.87, y = 5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.4, xend = 2.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 2.0, y = 5.45), size = plotFS/4, color = "gray20")
}
graphAnger
# graphs of group x CS effects on disgust ratings
graphDisgust <- ggplot(data = dataDisgustLongPost, aes(x = usGroup, y = btw, fill = CS, color = CS)) +
theme_classic() +
stat_summary(aes(y = wth), fun.data = mean_se, geom = "errorbar", position=position_dodge(0.8), width = 0.1, linewidth = 0.2) +
stat_summary(fun = mean, geom = "crossbar", position = position_dodge(0.8), width = 0.25, linewidth = 0.2) +
scale_fill_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_color_discrete(type = scico(n = 3, palette = "davos", begin = .1, end = .7)) +
scale_y_continuous(name = "Disgust rating (1-5)", limits = c(0.4,6), breaks = 1:5, oob = rescale_none, expand = c(0,0)) +
geom_vline(xintercept = 0.41) +
geom_rect(xmin = 0.4, xmax = 2.6, ymin = 0.35, ymax = 0.8, fill = "white", color = "white") +
geom_hline(yintercept = 0.8) +
geom_beeswarm(aes(color = CS), dodge.width = 0.8, cex = 0.6, size = .1, color = "gray70") +
geom_violin(alpha = .2, color = NA, bw = .5, position = position_dodge(0.8), width = 0.75) +
geom_text(x = 0.74, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.26, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(x = 1.74, y = 0.6, label = csLabels[1], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.0, y = 0.6, label = csLabels[2], colour = "black", size = plotFS/.pt) +
geom_text(x = 2.26, y = 0.6, label = csLabels[3], colour = "black", size = plotFS/.pt) +
geom_text(aes(label = usGroup, y = 5.9), colour = "black", size = (plotFS-2)/.pt, fontface = "bold") +
theme(legend.position = "none",
plot.title = element_text(size = plotFS, color = "black", face = "bold", hjust = .5),
axis.line.x = element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.y  = element_blank(),
axis.title.y = element_text(margin = margin(r = 5), size = plotFS),
axis.text.y = element_text(margin = margin(r = 5), size = plotFS, color = "black"),
axis.ticks.y = element_line(colour = "black"))
if (showSig == TRUE){
graphDisgust <- graphDisgust +
geom_segment(aes(x = 0.74, y = 5.1, xend = 1.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 0.87, y =5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 0.74, y = 5.4, xend = 1.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "***", x = 1.0, y = 5.45), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.1, xend = 2.0, yend = 5.1), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "**", x = 1.87, y = 5.15), size = plotFS/4, color = "gray20") +
geom_segment(aes(x = 1.74, y = 5.4, xend = 2.26, yend = 5.4), linewidth = 0.2, color = "gray20") +
geom_text(aes(label = "**", x = 2.0, y = 5.45), size = plotFS/4, color = "gray20")
}
graphDisgust
### combining graphs into one figure
# add margins to subplots
graphUnpleas <- graphUnpleas + theme(plot.margin = unit(c(5,5,5,5), "mm"))
graphArousal <- graphArousal + theme(plot.margin = unit(c(5,5,5,5), "mm"))
graphAnger <- graphAnger + theme(plot.margin = unit(c(5,5,5,5), "mm"))
graphDisgust <- graphDisgust + theme(plot.margin = unit(c(5,5,5,5), "mm"))
# merging the subplots
graphRatings <- ggarrange(graphUnpleas, graphArousal,
graphAnger, graphDisgust,
labels = c("A", "B", "C", "D"),
ncol = 2, nrow = 2)
# saving it
ggsave(filename = paste0(pathname, "/supplement/FigureSupp_plotOtherRatings.eps"),
plot = graphRatings,
width = 210,
height = 180,
units = "mm",
dpi = 300
)
ggsave(filename = paste0(pathname, "/supplement/FigureSupp_plotOtherRatings.pdf"),
plot = graphRatings,
device = "pdf",
width = 210,
height = 180,
units = "mm",
dpi = 300
)
